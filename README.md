# Slide Annotation Viewer

A simple application for viewing and annotating PowerPoint presentations generated by LangGraph agents. Presentations are converted to PDF for easy viewing and annotation.

## Architecture

```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│  LangGraph      │────▶│  FastAPI        │────▶│  React          │
│  Agent          │     │  Backend        │     │  Frontend       │
│  (PPTX bytes)   │     │  (LangSmith +   │     │  (PDF Viewer)   │
│                 │     │   PDF Convert)  │     │                 │
└─────────────────┘     └─────────────────┘     └─────────────────┘
```

## Prerequisites

**LibreOffice Required**: The application uses LibreOffice to convert PPTX files to PDF. Install it first:

- **macOS**: `brew install --cask libreoffice`
- **Ubuntu/Debian**: `sudo apt-get install libreoffice`
- **Windows**: Download from [libreoffice.org](https://www.libreoffice.org/)

## Quick Start

### 1. Run the Agent (generate presentations)

```bash
uv sync
uv run python financial_slide_agent.py
```

This creates PPTX files and logs traces to LangSmith.

### 2. Start the Backend

```bash
cd backend
pip install -r requirements.txt

# Set your LangSmith project name
export LANGSMITH_PROJECT="your-project-name"

python app.py
```

Backend runs on http://localhost:8000

### 3. Start the Frontend

```bash
cd frontend
npm install
npm run dev
```

Frontend runs on http://localhost:5173

## Features

- **Simple PDF Viewing**: Presentations are converted to PDF for reliable rendering
- **LangSmith Integration**: Fetches recent traces with PPTX outputs
- **Multi-page Support**: View all slides in a scrollable format
- **Download PPTX**: Download the original PowerPoint file for editing

## How It Works

1. The backend fetches PPTX files from LangSmith traces
2. PPTX files are converted to PDF using LibreOffice
3. PDFs are cached in memory for fast access
4. The frontend displays PDFs using react-pdf for annotation and viewing

## Environment Variables

| Variable | Description | Required |
|----------|-------------|----------|
| `LANGSMITH_API_KEY` | LangSmith API key | Yes |
| `LANGSMITH_PROJECT` | LangSmith project name | Yes |
| `OPENAI_API_KEY` | OpenAI API key (for agent) | Yes |

## API Endpoints

- `GET /api/traces` - Fetch recent traces with PPTX outputs
- `GET /api/traces/{trace_id}/slides.pdf` - Get PDF version of a presentation
- `GET /api/health` - Health check with service status

## Troubleshooting

### PDF Conversion Not Working

If you see "PDF Conversion Not Available" in the frontend:

1. **Check LibreOffice Installation**: Run `which soffice` (Unix) or `where soffice` (Windows) to verify LibreOffice is installed
2. **macOS Specific**: If installed via Homebrew, the path should be `/Applications/LibreOffice.app/Contents/MacOS/soffice`
3. **Check Backend Logs**: The backend will print conversion attempts and failures

You can still download the PPTX files even if PDF conversion is not working.

### Empty Traces

If no traces appear:
- Verify `LANGSMITH_PROJECT` environment variable matches your LangSmith project
- Check that your agent has run and created traces with `finalize_presentation` tool outputs
- Verify `LANGSMITH_API_KEY` is set correctly
